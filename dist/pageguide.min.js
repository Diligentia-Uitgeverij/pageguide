function PageGuide(e){"use strict";function t(){return c=r[document.title],"undefined"!=typeof c&&(a(),i(),o(),s(),void v.updateCanvas())}function i(){$("body").append('<canvas id="pageguide-mask"></canvas>'),p=$("#pageguide-mask"),g=document.getElementById("pageguide-mask").getContext("2d")}function o(){$("body").append('<article id="pageguide"><section class="header"><h1><span id="pageguide-title">pageguide-title</span><small id="pageguide-counter">1/5</small></h1></section><section class="body" id="pageguide-content"><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Culpa itaque quidem corporis sapiente, laboriosam quaerat soluta quas iure illum, hic accusantium provident reiciendis distinctio libero ut fugit alias vero neque.Explicabo perferendis voluptas excepturi ab veniam adipisci! Harum quos est itaque magnam doloribus ad modi quam alias recusandae id facere fugit repellendus sapiente nam ducimus iure vitae officia minus, dolorem?</p></section><section class="action"><div class="pageguide-btn-group"><div class="pageguide-btn" id="pageguide-btn-previous">&laquo;</div><div class="pageguide-btn" id="pageguide-btn-next">&raquo;</div></div><div class="pageguide-btn" id="pageguide-btn-close">&times;</div></section></article>'),l=$("#pageguide")}function a(){$("body").append('<div class="pageguide-btn" id="pageguide-start" data-title="help">?</div>')}function u(){return g.clearRect(0,0,m,b),g.fillStyle="rgba(0,0,0,0.5)",g.fillRect(0,0,m,b),"undefined"!=typeof h&&void g.clearRect(h.offset().left-5,h.offset().top-5,h.outerWidth()+10,h.outerHeight()+10)}function n(){$("#pageguide-title").empty().append(c[H].title),$("#pageguide-counter").empty().append(H+1+"/"+c.length),$("#pageguide-content").empty().append(c[H].content);var e=0,t=0,i=0,o=c[H].position;switch(o){case"top-left":e=h.offset().top-l.outerHeight()-3*y,t=h.offset().left,i=e-2*y;break;case"top-right":e=h.offset().top-l.outerHeight()-3*y,t=h.offset().left+h.outerWidth()-l.outerWidth(),i=e-2*y;break;case"bottom":e=h.offset().top+h.outerHeight()+3*y,t=h.offset().left-l.outerWidth()/2+h.outerWidth()/2,i=h.offset().top-2*y;break;case"bottom-left":e=h.offset().top+h.outerHeight()+3*y,t=h.offset().left,i=h.offset().top-2*y;break;case"bottom-right":e=h.offset().top+h.outerHeight()+3*y,t=h.offset().left+h.outerWidth()-l.outerWidth(),i=h.offset().top-2*y;break;case"left":e=h.offset().top+h.outerHeight()/2-l.outerHeight()/2,t=h.offset().left-l.outerWidth()-3*y,i=e-2*y;break;case"left-top":e=h.offset().top+h.outerHeight()/2-2*y,t=h.offset().left-l.outerWidth()-3*y,i=e-2*y;break;case"left-bottom":e=h.offset().top-l.outerHeight()+2*y+h.outerHeight()/2,t=h.offset().left-l.outerWidth()-3*y,i=e-2*y;break;case"right":e=h.offset().top+h.outerHeight()/2-l.outerHeight()/2,t=h.offset().left+h.outerWidth()+3*y,i=e-2*y;break;case"right-top":e=h.offset().top+h.outerHeight()/2-2*y,t=h.offset().left+h.outerWidth()+3*y,i=e-2*y;break;case"right-bottom":e=h.offset().top-l.outerHeight()+2*y+h.outerHeight()/2,t=h.offset().left+h.outerWidth()+3*y,i=e-2*y;break;default:e=h.offset().top-l.outerHeight()-3*y,t=h.offset().left-l.outerWidth()/2+h.outerWidth()/2,i=e-2*y,o="top"}l.css({top:e+"px",left:t+"px"}),l.removeClass(),l.addClass(o),$("html,body").animate({scrollTop:i},250,"easeOutQuad")}function s(){$("#pageguide-start").click(function(){v.start()}),p.click(function(){v.end()}),$("#pageguide-btn-previous").click(function(){v.previous()}),$("#pageguide-btn-next").click(function(){v.next()}),$("#pageguide-btn-close").click(function(){v.end()}),$(window).resize(function(){v.updateCanvas()}),$(window).keyup(function(e){if(k)switch(e.key){case"ArrowRight":return v.next(),!1;case"ArrowLeft":return v.previous(),!1;case"Escape":return v.end(),!1}})}function d(){return H++,H===c.length&&(H=0),h=$("#"+c[H].id),0===h.length?d():c}function f(){return H--,H===-1&&(H=c.length-1),h=$("#"+c[H].id),0===h.length?f():c}var r,c,p,g,l,h,m,b,v=this,k=!1,H=0,y=8;this.updateCanvas=function(){m=$(document).width(),b=$(document).height(),p.attr("width",m),p.attr("height",b),u()},this.start=function(){c=r[document.title].filter(function(e){return $("#"+e.id).length>0}),H=-1,d(),n(),u(),l.fadeIn(),p.fadeIn(),k=!0},this.next=function(){d(),n(),u()},this.previous=function(){f(),n(),u()},this.end=function(){l.fadeOut(),p.fadeOut(),k=!1},function(){"string"==typeof e?$.ajax({url:e}).done(function(e){r=e,t()}):(r=e,t())}()}